<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flicklet Functionality Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        button { margin: 5px; padding: 8px 16px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>🧪 Flicklet Functionality Test</h1>
    
    <div class="test-section" id="moduleLoading">
        <h3>📦 Module Loading Test</h3>
        <p id="moduleStatus">Testing...</p>
        <ul id="moduleList"></ul>
    </div>
    
    <div class="test-section" id="flickletAppTest">
        <h3>🚀 FlickletApp Object Test</h3>
        <p id="flickletStatus">Testing...</p>
        <ul id="flickletMethods"></ul>
    </div>
    
    <div class="test-section" id="functionsTest">
        <h3>⚙️ Core Functions Test</h3>
        <p id="functionsStatus">Testing...</p>
        <ul id="functionsList"></ul>
    </div>
    
    <div class="test-section" id="dataTest">
        <h3>💾 Data Persistence Test</h3>
        <button onclick="testDataPersistence()">Test Data Save/Load</button>
        <p id="dataStatus">Click button to test</p>
    </div>
    
    <div class="test-section" id="uiTest">
        <h3>🎨 UI Components Test</h3>
        <button onclick="testUIComponents()">Test UI Functions</button>
        <p id="uiStatus">Click button to test</p>
    </div>

    <script>
        // Test module loading
        function testModuleLoading() {
            const moduleList = document.getElementById('moduleList');
            const moduleStatus = document.getElementById('moduleStatus');
            const moduleSection = document.getElementById('moduleLoading');
            
            const modules = [
                { name: 'window.FlickletApp', obj: window.FlickletApp },
                { name: 'loadAppData', obj: window.loadAppData },
                { name: 'saveAppData', obj: window.saveAppData },
                { name: 'switchToTab', obj: window.switchToTab },
                { name: 'updateUI', obj: window.updateUI },
                { name: 'addToListFromCache', obj: window.addToListFromCache },
                { name: 'moveItem', obj: window.moveItem },
                { name: 'removeItemFromCurrentList', obj: window.removeItemFromCurrentList },
                { name: 'showNotification', obj: window.showNotification },
                { name: 't (translation)', obj: window.t },
                { name: 'applyTranslations', obj: window.applyTranslations }
            ];
            
            let allLoaded = true;
            moduleList.innerHTML = '';
            
            modules.forEach(module => {
                const li = document.createElement('li');
                const isLoaded = typeof module.obj !== 'undefined';
                li.innerHTML = `${module.name}: <span style="color: ${isLoaded ? 'green' : 'red'}">${isLoaded ? '✅ Loaded' : '❌ Missing'}</span>`;
                moduleList.appendChild(li);
                if (!isLoaded) allLoaded = false;
            });
            
            if (allLoaded) {
                moduleStatus.textContent = '✅ All modules loaded successfully!';
                moduleSection.classList.add('success');
            } else {
                moduleStatus.textContent = '❌ Some modules failed to load';
                moduleSection.classList.add('error');
            }
        }
        
        // Test FlickletApp object
        function testFlickletApp() {
            const flickletMethods = document.getElementById('flickletMethods');
            const flickletStatus = document.getElementById('flickletStatus');
            const flickletSection = document.getElementById('flickletAppTest');
            
            if (!window.FlickletApp) {
                flickletStatus.textContent = '❌ FlickletApp not found';
                flickletSection.classList.add('error');
                return;
            }
            
            const methods = [
                'init', 'switchToTab', 'updateUI', 'updateDataStatistics', 
                'loadData', 'applyTheme', 'applyLanguage', 'showNotification'
            ];
            
            let allMethodsExist = true;
            flickletMethods.innerHTML = '';
            
            methods.forEach(method => {
                const li = document.createElement('li');
                const exists = typeof window.FlickletApp[method] === 'function';
                li.innerHTML = `${method}: <span style="color: ${exists ? 'green' : 'red'}">${exists ? '✅ Available' : '❌ Missing'}</span>`;
                flickletMethods.appendChild(li);
                if (!exists) allMethodsExist = false;
            });
            
            if (allMethodsExist) {
                flickletStatus.textContent = '✅ FlickletApp object is complete!';
                flickletSection.classList.add('success');
            } else {
                flickletStatus.textContent = '❌ FlickletApp is missing some methods';
                flickletSection.classList.add('error');
            }
        }
        
        // Test core functions
        function testCoreFunctions() {
            const functionsList = document.getElementById('functionsList');
            const functionsStatus = document.getElementById('functionsStatus');
            const functionsSection = document.getElementById('functionsTest');
            
            const functions = [
                'loadAppData', 'saveAppData', 'switchToTab', 'updateUI',
                'addToListFromCache', 'moveItem', 'removeItemFromCurrentList',
                'setRating', 'setLikeStatus', 'openTMDBLink', 'displaySearchResults',
                'loadGenres', 'startDailyCountdown', 'updateFlickWordStats'
            ];
            
            let allFunctionsExist = true;
            functionsList.innerHTML = '';
            
            functions.forEach(func => {
                const li = document.createElement('li');
                const exists = typeof window[func] === 'function';
                li.innerHTML = `${func}: <span style="color: ${exists ? 'green' : 'red'}">${exists ? '✅ Available' : '❌ Missing'}</span>`;
                functionsList.appendChild(li);
                if (!exists) allFunctionsExist = false;
            });
            
            if (allFunctionsExist) {
                functionsStatus.textContent = '✅ All core functions are available!';
                functionsSection.classList.add('success');
            } else {
                functionsStatus.textContent = '❌ Some core functions are missing';
                functionsSection.classList.add('error');
            }
        }
        
        // Test data persistence
        function testDataPersistence() {
            const dataStatus = document.getElementById('dataStatus');
            const dataSection = document.getElementById('dataTest');
            
            try {
                // Test data save/load
                const testData = { test: 'value', timestamp: Date.now() };
                localStorage.setItem('flicklet-test', JSON.stringify(testData));
                
                const loaded = JSON.parse(localStorage.getItem('flicklet-test'));
                
                if (loaded && loaded.test === 'value') {
                    dataStatus.textContent = '✅ Data persistence works!';
                    dataSection.classList.add('success');
                    localStorage.removeItem('flicklet-test'); // cleanup
                } else {
                    dataStatus.textContent = '❌ Data persistence failed';
                    dataSection.classList.add('error');
                }
            } catch (error) {
                dataStatus.textContent = '❌ Data persistence error: ' + error.message;
                dataSection.classList.add('error');
            }
        }
        
        // Test UI components
        function testUIComponents() {
            const uiStatus = document.getElementById('uiStatus');
            const uiSection = document.getElementById('uiTest');
            
            try {
                // Test notification system
                if (typeof showNotification === 'function') {
                    showNotification('Test notification', 'success');
                    uiStatus.textContent = '✅ UI components work! (Check for test notification)';
                    uiSection.classList.add('success');
                } else {
                    uiStatus.textContent = '❌ showNotification function not available';
                    uiSection.classList.add('error');
                }
            } catch (error) {
                uiStatus.textContent = '❌ UI components error: ' + error.message;
                uiSection.classList.add('error');
            }
        }
        
        // Run tests when page loads
        window.addEventListener('DOMContentLoaded', () => {
            // Wait a bit for modules to load
            setTimeout(() => {
                testModuleLoading();
                testFlickletApp();
                testCoreFunctions();
            }, 1000);
        });
    </script>
    
    <!-- Load the same modules as the main app -->
    <script src="www/js/utils.js"></script>
    <script src="www/js/i18n.js"></script>
    <script src="www/js/functions.js"></script>
    <script src="www/js/app.js"></script>
    <script src="www/js/bootstrap.js"></script>
</body>
</html>

