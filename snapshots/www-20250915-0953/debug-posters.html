<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Posters</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .poster-test { margin: 10px 0; }
        .poster-test img { max-width: 100px; height: auto; margin: 5px; }
        .debug-info { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 3px; }
    </style>
</head>
<body>
    <h1>Poster Debug Tool</h1>
    
    <div class="debug-section">
        <h2>App Data Debug</h2>
        <button onclick="debugAppData()">Check App Data</button>
        <div id="appDataOutput" class="debug-info"></div>
    </div>
    
    <div class="debug-section">
        <h2>Currently Watching Items</h2>
        <button onclick="debugCurrentlyWatching()">Check Currently Watching</button>
        <div id="currentlyWatchingOutput" class="debug-info"></div>
    </div>
    
    <div class="debug-section">
        <h2>Poster URL Tests</h2>
        <button onclick="testPosterUrls()">Test Poster URLs</button>
        <div id="posterTestOutput" class="debug-info"></div>
    </div>

    <script>
        function debugAppData() {
            const output = document.getElementById('appDataOutput');
            if (window.appData) {
                output.innerHTML = `
                    <h3>App Data Structure:</h3>
                    <pre>${JSON.stringify(window.appData, null, 2)}</pre>
                `;
            } else {
                output.innerHTML = '<p>❌ window.appData not available</p>';
            }
        }
        
        function debugCurrentlyWatching() {
            const output = document.getElementById('currentlyWatchingOutput');
            if (window.appData && window.appData.tv && window.appData.tv.watching) {
                const items = window.appData.tv.watching;
                let html = `<h3>TV Watching Items (${items.length}):</h3>`;
                items.forEach((item, index) => {
                    html += `
                        <div class="poster-test">
                            <strong>Item ${index + 1}:</strong> ${item.title || item.name || 'Unknown'}<br>
                            <strong>ID:</strong> ${item.id}<br>
                            <strong>Poster Path:</strong> ${item.poster_path || 'NONE'}<br>
                            <strong>Media Type:</strong> ${item.media_type || 'unknown'}<br>
                            ${item.poster_path ? `<img src="https://image.tmdb.org/t/p/w200${item.poster_path}" alt="Poster" onerror="this.style.border='2px solid red'; this.alt='BROKEN IMAGE';"><br>` : ''}
                            <hr>
                        </div>
                    `;
                });
                output.innerHTML = html;
            } else {
                output.innerHTML = '<p>❌ No currently watching items found</p>';
            }
        }
        
        function testPosterUrls() {
            const output = document.getElementById('posterTestOutput');
            const testItems = [
                { id: 1, title: 'Test Show 1', poster_path: '/test1.jpg' },
                { id: 2, title: 'Test Show 2', poster_path: '/test2.jpg' },
                { id: 3, title: 'Test Show 3', poster_path: null }
            ];
            
            let html = '<h3>Poster URL Construction Tests:</h3>';
            testItems.forEach(item => {
                const TMDB_IMG_BASE = "https://image.tmdb.org/t/p/w200";
                const posterUrl = item.poster_path ? `${TMDB_IMG_BASE}${item.poster_path}` : null;
                html += `
                    <div class="poster-test">
                        <strong>${item.title}:</strong><br>
                        Poster Path: ${item.poster_path || 'null'}<br>
                        Constructed URL: ${posterUrl || 'null'}<br>
                        ${posterUrl ? `<img src="${posterUrl}" alt="Test Poster" onerror="this.style.border='2px solid red'; this.alt='BROKEN IMAGE';"><br>` : 'No poster URL'}<br>
                        <hr>
                    </div>
                `;
            });
            output.innerHTML = html;
        }
        
        // Auto-run when page loads
        window.addEventListener('load', () => {
            setTimeout(() => {
                debugAppData();
                debugCurrentlyWatching();
                testPosterUrls();
            }, 1000);
        });
    </script>
</body>
</html>
