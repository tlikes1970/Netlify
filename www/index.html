<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Flicklet - TV & Movie Tracker</title>
    <meta
      name="description"
      content="Search, track, and rate shows & films fast."
    />
    
    <!-- Icons for different platforms -->
    <link rel="icon" href="icons/icon-512.png" />
    <link rel="apple-touch-icon" href="icons/icon-192.png" />
    <link rel="manifest" href="manifest.json" />

    <link rel="stylesheet" href="styles/inline-style-01.css?v=desktop-fix2">
    <link rel="stylesheet" href="styles/inline-style-02.css">
    <link rel="stylesheet" href="styles/components.css?v=pro-gate-1">
    <link rel="stylesheet" href="styles/mobile.css?v=mp2.2d">

    <!-- Feature flags and safety guard -->
    <script src="js/flags.js"></script>
    
    <!-- Immediate mobile detection -->
    <script>
      (function() {
        // Check if this is a mobile device
        const isMobileDevice = /iPhone|iPad|iPod|Android|Mobile|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        const isMobileSize = window.innerWidth <= 768;
        
        if (isMobileDevice && isMobileSize && document.body) {
          document.body.classList.add('mobile-v1');
          console.log('üì± Mobile class applied immediately - iPhone detected');
        }
      })();
    </script>

</head>

  <body>
    <!-- Centralized Flicklet App Object -->
    <script src="scripts/inline-script-01.js?v=desktop-fix"></script>

    <!-- Main Container -->
    <div class="main-container" id="appRoot">
      <header class="header" role="banner" data-lang-layout="inline">
        <!-- New left-side container for username and snarky phrase -->
        <div id="usernameSnarkContainer" style="text-align: left; min-width: 200px;">
          <div id="dynamicUsername" style="font-size: 18px; font-weight: bold; color: #9c27b0; margin-bottom: 4px;">Welcome!</div>
          <div id="dynamicSnark" style="font-size: 14px; color: #7f8c8d; font-style: italic;">Ready to track your shows</div>
        </div>
        
        <div class="header-center">
          <h1 id="welcomeText" class="title" data-i18n="app_title">Flicklet</h1>
          <div id="proBadge" class="pro-badge" style="display: none;">PRO</div>
          <div id="snarkySubtitle" class="subtitle" data-i18n="subtitle">TV & Movie Tracker</div>
          <div id="bingeBanner" class="binge-banner" aria-live="polite"></div>
        </div>
        <div class="user-section">
          <div style="display: flex; flex-direction: column; align-items: center; gap: 4px;">
            <div id="accountHint" style="font-size: 11px; color: #7f8c8d; text-align: center; opacity: 0.8;"></div>
            <button
              id="accountBtn"
              class="btn secondary"
              title="Sign in / Account"
              aria-label="Account - sign in or manage your account"
            >
              üë§ <span data-i18n="sign_in_account">Sign In</span>
            </button>
            <button id="shareOpenBtn" class="btn secondary" data-share-title="Flicklet ‚Äî My List" data-share-url="" title="Share this page" aria-label="Share this page">
              üîó <span>Share</span>
            </button>
            <select id="langToggle" aria-label="Language" title="Language" onchange="changeLanguage(this.value).catch(console.error)">
              <option value="en">EN</option>
              <option value="es">ES</option>
            </select>
          </div>
        </div>
      </header>


      <!-- Sticky Top Search -->
      <div class="top-search">

        <div class="search-help">
          <small>üí° <span data-i18n="search_tips">Search tips: Use * for wildcards (e.g., "marvel*" for Marvel shows)</span></small>
          <span class="onboarding-hint">
            <span class="tooltip">Search for any TV show or movie. Try typing "breaking" or "marvel*" to see how wildcards work!</span>
          </span>
          <span class="keyboard-hint">
            <span class="tooltip">
              <strong>Keyboard Shortcuts:</strong><br>
              ‚Ä¢ <kbd>Ctrl/Cmd + K</kbd> - Focus search<br>
              ‚Ä¢ <kbd>Ctrl/Cmd + T</kbd> - Toggle theme<br>
              ‚Ä¢ <kbd>Ctrl/Cmd + M</kbd> - Toggle Mardi Gras<br>
              ‚Ä¢ <kbd>1-5</kbd> - Switch tabs<br>
              ‚Ä¢ <kbd>Esc</kbd> - Clear search
            </span>
          </span>
        </div>
        <div class="search-row">
          <input
            id="searchInput"
            class="search-input search-area-input"
            placeholder=""
            data-i18n-placeholder="search_placeholder"
          />
          <div class="search-controls">
            <select id="genreFilter" class="genre-filter search-area-genre">
              <option value="" data-i18n="all_genres">All Genres</option>
            </select>
            <button id="searchBtn" class="btn search-btn search-area-search" aria-label="Search for TV shows and movies">
              <span class="icon" aria-hidden="true">üîç</span>
              <span class="label" data-i18n="search">Search</span>
            </button>
            <button id="clearSearchBtn" class="btn secondary clear-search-btn search-area-clear" aria-label="Clear search results">
              <span class="icon" aria-hidden="true">‚úñÔ∏è</span>
              <span class="label" data-i18n="clear">Clear</span>
            </button>
            
            <!-- Search Tips Toggle -->
            <div id="searchTips" class="search-tips">
              <button class="tips-trigger" id="tipsTrigger"
                      type="button"
                      aria-label="Search tips"
                      aria-expanded="false"
                      aria-controls="tipsPop">?</button>

              <!-- Popover lives next to trigger, hidden by default -->
              <div class="tips-pop" id="tipsPop" role="dialog" aria-modal="false" hidden>
                <div class="tips-head">
                  <div class="tips-title">Search tips</div>
                  <button class="tips-close" id="tipsClose" aria-label="Close">√ó</button>
                </div>
                <ul class="tips-list">
                  <li><code>"exact phrase"</code> finds an exact title.</li>
                  <li><code>alien year:2025</code> filters by year.</li>
                  <li><code>genre:sci-fi</code> narrows by genre.</li>
                  <li><code>status:watching</code> your current list.</li>
                  <li><code>rating:‚â•4</code> your rating or higher.</li>
                  <li><code>is:movie</code> or <code>is:show</code>.</li>
                </ul>
                <div class="tips-actions">
                  <label class="tips-dontshow">
                    <input id="tipsDontShow" type="checkbox"> Don't show again
                  </label>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div
          id="tagFilterRow"
          class="tag-filters"
          aria-label="Tag filters"
        >        </div>
      </div>

          <!-- Curated Sections -->
    <section id="curatedSections" class="curated-sections" aria-label="Curated lists">
      <!-- Populated by curated-rows.js -->
    </section>

    <!-- Trivia (daily) -->
    <section id="triviaTile" class="trivia-card" aria-labelledby="triviaTitle">
      <div class="trivia-head">
        <h2 id="triviaTitle">Trivia</h2>
        <div class="trivia-stats" aria-live="polite" aria-atomic="true"></div>
      </div>
      <div class="trivia-body">
        <div class="trivia-question" id="triviaQuestion"></div>
        <ul class="trivia-choices" id="triviaChoices" role="listbox"></ul>
        <div class="trivia-feedback" id="triviaFeedback" aria-live="polite"></div>
        <div class="trivia-actions">
          <button class="btn" id="triviaNextBtn" hidden>Next</button>
        </div>
      </div>
    </section>

    <!-- Daily Video Spotlight -->
    <section id="videoSpotlight" class="spotlight-card" aria-labelledby="spotlightTitle">
      <div class="spotlight-head">
        <h2 id="spotlightTitle">Daily Video Spotlight</h2>
        <div class="spotlight-date" aria-live="polite" aria-atomic="true"></div>
      </div>

      <div class="spotlight-media" id="spotlightMedia" role="region" aria-label="Featured video"></div>

      <div class="spotlight-meta">
        <div class="spotlight-title" id="spotlightItemTitle"></div>
        <div class="spotlight-desc" id="spotlightDesc"></div>
        <div class="spotlight-actions">
          <button class="btn" id="spotlightPlayBtn">Play</button>
          <button class="btn" id="spotlightMuteBtn" aria-pressed="true">Unmute</button>
        </div>
      </div>
    </section>

    <!-- Series Organization -->
    <section id="seriesOrg" class="series-block" aria-label="Series organization">
      <!-- JS will render here. To force a specific series, add data-series-id="157239" (Alien: Earth example) -->
    </section>


      <div class="tab-container">
        <button id="homeTab" class="tab active" title="Overview of your TV & movie tracking" aria-label="Home tab - view dashboard and recommendations">üè† <span data-i18n="home">Home</span></button>
        <button id="watchingTab" class="tab" title="Shows and movies you're currently watching" aria-label="Watching tab - view shows and movies you're currently watching">
          ‚ñ∂Ô∏è <span data-i18n="currently_watching">Currently Watching</span>
          <span class="tab-badge" id="watchingBadge">0</span>
        </button>
        <button id="wishlistTab" class="tab" title="Shows and movies you want to watch later" aria-label="Wishlist tab - view shows and movies you want to watch">
          üìñ <span data-i18n="want_to_watch">Want to Watch</span>
          <span class="tab-badge" id="wishlistBadge">0</span>
        </button>
        <button id="watchedTab" class="tab" title="Shows and movies you've already finished" aria-label="Watched tab - view shows and movies you've completed">
          ‚úÖ <span data-i18n="already_watched">Already Watched</span>
          <span class="tab-badge" id="watchedBadge">0</span>
        </button>
        <button id="discoverTab" class="tab" title="Get personalized recommendations based on your taste" aria-label="Discover tab - find new shows and movies">‚ú® <span data-i18n="discover">Discover</span></button>
      </div>

      <!-- Quote of the Day and FlickWord Container -->
      <div class="quote-flickword-container">
        <div class="left-column">
          <div id="quoteCard" class="quote-card">
            <h3 class="quote-title">üí≠ <span data-i18n="quote_of_the_day">Quote of the Day</span></h3>
            <div class="quote-content" id="dailyQuote">
              <p class="quote-text">"The best way to predict the future is to create it."</p>
              <p class="quote-author">- Peter Drucker</p>
            </div>
          </div>
          <div id="randomQuoteCard" class="random-quote-card">
            <h3 class="quote-title">üé≤ <span data-i18n="random_quote">Random Quote</span></h3>
            <div class="quote-content" id="randomQuote">
              <p class="quote-text">"One does not simply watch one episode."</p>
              <p class="quote-author">- Some dude</p>
            </div>
          </div>
        </div>
        <div id="flickwordCard" class="flickword-card">
          <h3 class="flickword-title">üéØ <span data-i18n="flickword_daily_challenge">FlickWord Daily Challenge</span></h3>
          <div class="flickword-timer-section">
            <div class="flickword-countdown" id="fwCountdown">00:00:00</div>
            <div class="flickword-motivation" id="flickwordMotivation"><span data-i18n="hours_left_motivation">Hours left to play today's game!</span></div>
          </div>
          <div class="flickword-stats">
            <div class="stat-item">
              <span class="stat-label">üî• <span data-i18n="streak">STREAK</span></span>
              <span class="stat-value" id="fwStreak">0</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">üèÜ <span data-i18n="best">BEST</span></span>
              <span class="stat-value" id="fwBest">-</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">üìä <span data-i18n="played">PLAYED</span></span>
              <span class="stat-value" id="fwPlayed">0</span>
            </div>
          </div>
          <div class="flickword-actions">
            <button id="fwPlayBtn" class="btn primary" data-i18n="play_todays_word">Play Today's Word</button>
          </div>
        </div>
      </div>

      <!-- FlickWord Modal -->
      <div id="fwModal" class="fw-modal" style="display: none;">
        <div class="fw-modal-content">
          <div class="fw-modal-header" id="fwModalHeader">
            <div class="fw-modal-title">FlickWord</div>
            <div class="fw-modal-controls">
              <button id="fwMinimize" class="fw-control-btn minimize" title="Minimize">‚àí</button>
              <button id="fwMaximize" class="fw-control-btn maximize" title="Maximize">‚ñ°</button>
              <button id="fwClose" class="fw-control-btn close" title="Close">&times;</button>
            </div>
          </div>
          <iframe id="fwFrame" src="" frameborder="0"></iframe>
        </div>
      </div>

      <!-- Results -->
      <div id="searchResults" class="section" style="display: none">
                  <h3>
            üéØ <span data-i18n="search_results">Search Results</span> <span class="count" id="resultsCount">0</span>
          </h3>
        <div id="searchResultsList" class="list-container"></div>
      </div>

      <!-- Home -->
      <div id="homeSection" class="tab-section">
        <div class="stats">
          <div class="stat" id="bingeMeter"></div>
        </div>
        
        <!-- Stats Section -->
        <div id="statsBasicBody" data-i18n="loading">Loading‚Ä¶</div>
        <div id="statsPro" style="display: none;">
          <div id="statsProBody"></div>
        </div>
      </div>

      <main id="main" role="main">

      <!-- Watching -->
      <div id="watchingSection" class="tab-section" style="display: none">
        <div class="section">
          <div class="section-header">
            <h3>
              ‚ñ∂Ô∏è <span data-i18n="currently_watching">Currently Watching</span>
              <span class="count" id="watchingCount">0</span>
            </h3>
          </div>
          <div id="watchingList" class="list-container"></div>
        </div>
      </div>

      <!-- Wishlist -->
      <div id="wishlistSection" class="tab-section" style="display: none">
        <div class="section">
          <div class="section-header">
            <h3>
              üìñ <span data-i18n="want_to_watch">Want to Watch</span>
              <span class="count" id="wishlistCount">0</span>
            </h3>
          </div>
          <div id="wishlistList" class="list-container"></div>
        </div>
      </div>

      <!-- Watched -->
      <div id="watchedSection" class="tab-section" style="display: none">
        <div class="section">
          <div class="section-header">
            <h3>
              ‚úÖ <span data-i18n="already_watched">Already Watched</span>
              <span class="count" id="watchedCount">0</span>
            </h3>
          </div>
          <div id="watchedList" class="list-container"></div>
        </div>
      </div>

      <!-- Discover -->
              <div id="discoverSection" class="tab-section" style="display: none">
          <div class="section">
            <h3>‚ú® <span data-i18n="discover">Discover</span></h3>
            <p data-i18n="discover_description">Recommendations based on your likes and ratings.</p>
            <div id="discoverList" class="list-container"></div>
          </div>
        </div>

      <!-- Settings / Profile -->
              <div id="settingsSection" class="tab-section" style="display: none">
            <div class="settings-tabs" role="tablist" aria-label="Settings Sections">
              <button role="tab" aria-selected="true" class="active" data-target="#general">General</button>
              <button role="tab" aria-selected="false" data-target="#notifications">Notifications</button>
              <button role="tab" aria-selected="false" data-target="#layout">Layout</button>
              <button role="tab" aria-selected="false" data-target="#data">Data</button>
              <button role="tab" aria-selected="false" data-target="#pro">Pro</button>
              <button role="tab" aria-selected="false" data-target="#about">About</button>
            </div>

          <div class="section">
            <section id="general" class="settings-section">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3>‚öôÔ∏è <span data-i18n="settings">Settings</span></h3>
              <div style="display: flex; align-items: center; gap: 10px;">
                <label for="displayNameInput" style="font-weight: 500; color: var(--text); white-space: nowrap;">
                  What would you like us to call you?
                </label>
                <input
                  id="displayNameInput"
                  class="search-input"
                  placeholder="Enter your name"
                  style="width: 150px; min-width: 120px;"
                />
                <button id="saveNameBtn" class="btn secondary" onclick="saveDisplayName()">
                  üíæ <span data-i18n="save_name">Save</span>
                </button>
              </div>
            </div>

              <!-- Stats Section (moved to first) -->
              <div id="statsCard" class="card">
                <h4>üìä My Statistics</h4>
                <div id="statsContent">
                  <div class="loading">Loading stats...</div>
                </div>
              </div>

              <!-- Manage Not Interested Section (moved to second) -->
              <div class="card">
                <h4>üö´ Not Interested Management</h4>
                <p style="margin: 0 0 15px 0; font-size: 0.9rem; color: var(--text-secondary); line-height: 1.4;">
                  Manage shows and movies you've marked as not interested. These won't appear in your recommendations.
                </p>
                <button id="manageNotInterestedBtn" class="btn" onclick="openNotInterestedModal()" style="width: 25%; min-width: 150px; margin-bottom: 8px;">
                  üö´ Manage Not Interested List
                </button>
              </div>
            </section>

            <section id="notifications" class="settings-section">
              <!-- Notifications Section (moved to third) -->
              <div class="card">
                <h4>üîî <span data-i18n="notifications">Notifications</span></h4>
                <p style="margin: 0 0 15px 0; font-size: 0.9rem; color: var(--text-secondary); line-height: 1.4;">
                  Choose which types of notifications you'd like to receive about your TV shows and movies
                </p>
                <p style="margin: 0 0 15px 0; font-size: 0.8rem; color: var(--text-tertiary); font-style: italic;">
                  These are basic notifications. Pro users get advanced notification features below.
                </p>
                <div
                  style="
                    display: flex;
                    gap: 10px;
                    flex-wrap: wrap;
                    align-items: center;
                    margin-bottom: 8px;
                  "
                >
                  <label
                    ><input type="checkbox" id="notifEpisodes" /> <span data-i18n="episode_alerts">Upcoming episode alerts</span></label
                  >
                  <label
                    ><input type="checkbox" id="notifDiscover" /> <span data-i18n="weekly_discover">Weekly discover picks</span></label
                  >
                  <label
                    ><input type="checkbox" id="notifDigest" /> <span data-i18n="monthly_digest">Monthly stats digest</span></label
                  >
                </div>
              </div>
            </section>

            <section id="layout" class="settings-section">
              <div class="card">
                <h4>üé® Layout Settings</h4>
                <p style="margin: 0 0 15px 0; font-size: 0.9rem; color: var(--text-secondary); line-height: 1.4;">
                  Customize how your lists and cards are displayed
                </p>
                <div style="margin-bottom: 15px;">
                  <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                    <input type="checkbox" id="condensedMode" />
                    <span>Condensed list view (more items per screen)</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                    <input type="checkbox" id="showPosters" checked />
                    <span>Show movie/TV show posters</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 8px;">
                    <input type="checkbox" id="darkMode" />
                    <span>Dark mode (auto-detect system preference)</span>
                  </label>
                </div>
              </div>
            </section>

            <section id="data" class="settings-section">
              <h3>Data</h3>

                             <div class="btn-row" style="display:flex; gap:12px; flex-wrap:wrap;">
                 <button id="exportBtn" class="btn secondary" aria-label="Export data to JSON">Export JSON</button>

                 <input type="file" id="importInput" accept=".json,application/json" hidden />
                 <button id="importBtn" class="btn secondary" aria-label="Import data from JSON">Import JSON</button>

                 <!-- Example gated controls -->
                 <button class="btn" data-pro="required" data-pro-mode="disable" data-pro-feature="extra-trivia">
                   Extra Trivia (Pro)
                 </button>

                 <button class="btn" data-pro="required" data-pro-mode="hide" data-pro-feature="export-csv">
                   Export CSV (Pro)
                 </button>

                 <button id="resetBtn" class="btn danger" aria-label="Reset all data (requires confirmation)">
                   Reset (Nuclear Option)
                 </button>
               </div>

              <p class="hint" style="color:var(--color-muted); font-size:12px; margin-top:8px;">
                Export saves <code>flicklet-export.json</code> to your device's Downloads/Files. Import accepts a valid Flicklet export.
              </p>
            </section>

            <section id="pro" class="settings-section">
              <!-- Pro Tier Offerings (moved to fourth) -->
              <div class="card">
                <h4>‚≠ê Pro Tier Offerings</h4>
                <p style="margin: 0 0 15px 0; font-size: 0.9rem; color: var(--text-secondary); line-height: 1.4;">
                  Unlock advanced features and premium content with Flicklet Pro. Get personalized recommendations, 
                  advanced analytics, priority support, and exclusive content.
                </p>
                
                <!-- Preview Pro Button -->
                <div style="margin-bottom: 20px;">
                  <button id="previewProBtn" class="btn primary" style="width: 25%; min-width: 150px; margin-bottom: 8px;" onclick="toggleProPreview()">
                    ‚≠ê Preview Pro Features
                  </button>
                  <p style="margin: 0; font-size: 0.9rem; color: var(--text-secondary); line-height: 1.4;">
                    Toggle Pro features on/off to see what's available
                  </p>
                </div>
                
                <div style="margin-bottom: 15px;">
                  <h5 style="margin: 0 0 8px 0; color: var(--text); font-size: 0.9rem;">‚ú® Pro Features Include:</h5>
                  <div id="proFeaturesList">
                    <!-- Dynamic Pro features list will be rendered here -->
                  </div>
                </div>
              </div>
            </section>

            <section id="about" class="settings-section">
              <!-- Share Your Thoughts Section (moved to last) -->
              <div class="card">
                <h4>üí¨ Share Your Thoughts</h4>
                <p data-i18n="feedback_working">Share your thoughts! Give us app feedback, tell us what's working (or not), share a quote for our rotation, make a confession, or just vent. We're listening!</p>
                <form name="feedback" method="POST" data-netlify="true" netlify-honeypot="bot-field" class="feedback-form" action="/thank-you">
                  <input type="hidden" name="form-name" value="feedback" />
                  <input type="hidden" name="theme" id="feedbackThemeInput" />
                  <div style="display: none;">
                    <label>Don't fill this out if you're human: <input name="bot-field" /></label>
                  </div>
                  <div style="display: flex; gap: 8px; flex-wrap: wrap">
                    <textarea
                      name="message"
                      class="search-input"
                      placeholder="Share your thoughts, feedback, quotes, or just vent! We're listening."
                      rows="3"
                      required
                      style="resize: vertical; min-height: 60px;"
                    ></textarea>
                    <button type="submit" class="btn">üì§ Share It!</button>
                  </div>
                </form>
              </div>
            </section>
          </div>

          <!-- Share Selection Modal -->
          <div id="shareSelectionModal" class="modal-backdrop" style="display: none;">
            <div class="modal share-modal" style="max-width: 800px; max-height: 80vh;">
              <h3>üîó <span data-i18n="share_selected">Share Selected Items</span></h3>
              
              <!-- Select All Controls -->
              <div class="select-all-controls" style="margin-bottom: 20px; padding: 15px; background: var(--card); border-radius: 8px;">
                <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                  <label style="display: flex; align-items: center; gap: 8px;">
                    <input type="checkbox" id="selectAllWatching" />
                    <strong>üì∫ <span data-i18n="currently_watching">Currently Watching</span></strong>
                  </label>
                  <label style="display: flex; align-items: center; gap: 8px;">
                    <input type="checkbox" id="selectAllWishlist" />
                    <strong>üìñ <span data-i18n="want_to_watch">Want to Watch</span></strong>
                  </label>
                  <label style="display: flex; align-items: center; gap: 8px;">
                    <input type="checkbox" id="selectAllWatched" />
                    <strong>‚úÖ <span data-i18n="already_watched">Already Watched</span></strong>
                  </label>
                  <label style="display: flex; align-items: center; gap: 8px;">
                    <input type="checkbox" id="selectAllEverything" />
                    <strong>üåü <span data-i18n="select_all_everything">Select All Everything</span></strong>
                  </label>
                </div>
              </div>

              <!-- Items Lists -->
              <div class="share-items-container" style="max-height: 400px; overflow-y: auto; margin-bottom: 20px;">
                <!-- Currently Watching -->
                <div class="share-list-section">
                  <h4>üì∫ <span data-i18n="currently_watching">Currently Watching</span></h4>
                  <div id="shareWatchingList" class="share-items-list"></div>
                </div>
                
                <!-- Want to Watch -->
                <div class="share-list-section">
                  <h4>üìñ <span data-i18n="want_to_watch">Want to Watch</span></h4>
                  <div id="shareWishlistList" class="share-items-list"></div>
                </div>
                
                <!-- Already Watched -->
                <div class="share-list-section">
                  <h4>‚úÖ <span data-i18n="already_watched">Already Watched</span></h4>
                  <div id="shareWatchedList" class="share-items-list"></div>
                </div>
              </div>

                            <!-- Action Buttons -->
              <div class="modal-actions" style="display: flex; gap: 10px; justify-content: center;">
                <button id="generateShareLinkBtn" class="btn success" style="display: none;" onclick="generateShareLinkFromSelected()">
                  üìã <span data-i18n="generate_share_link">Select what to share</span>
                </button>
                <button id="copyShareBtn" class="btn primary" style="display: none;" onclick="copyShareList()">
                  üìã Copy
                </button>
                <button id="closeShareModalBtn" class="btn secondary">
                  ‚úñÔ∏è <span data-i18n="close">Close</span>
                </button>
              </div>
            </div>
          </div>
  
          </div>
      </div>
    </div>

    <!-- Firebase (compat for simplicity) -->
      </main>

    <!-- Floating Action Buttons - Outside main container -->
    <button id="mardiToggle" class="fab" aria-label="Mardi">üé≠</button>
    <button id="darkModeToggle" class="fab" aria-label="Dark">
      <span id="themeIcon">üåô</span>
    </button>
    <button id="settingsTab" class="fab-left" aria-label="Settings">‚öôÔ∏è</button>

    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <script src="js/functions.js"></script>
    <script src="scripts/inline-script-02.js?v=desktop-fix"></script>

    <script src="scripts/inline-script-03.js?v=desktop-fix"></script>

    <script>
    // Welcome message functionality
    document.addEventListener('DOMContentLoaded', function() {
      const welcomeMessage = document.getElementById('welcomeMessage');
      if (!welcomeMessage) return;

      let fadeTimeout;

      const hideMessage = () => {
        welcomeMessage.classList.add('fade-out');
        setTimeout(() => {
          welcomeMessage.style.display = 'none';
        }, 500); // Match CSS transition duration
      };

      // Hide on any key press
      const handleKeyPress = () => {
        hideMessage();
        document.removeEventListener('keydown', handleKeyPress);
        clearTimeout(fadeTimeout);
      };

      // Auto-fade after 4 seconds
      fadeTimeout = setTimeout(hideMessage, 4000);

      // Hide on key press
      document.addEventListener('keydown', handleKeyPress);
    });
    </script>
    
    <!-- Force mobile class on iPhone -->
    <script>
      (function() {
        // Force mobile class for iPhone users
        const userAgent = navigator.userAgent;
        const isMobileDevice = /iPhone|iPad|iPod|Android|Mobile|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);
        const isIPhone = /iPhone/i.test(userAgent);
        const viewportWidth = window.innerWidth;
        const isMobileSize = viewportWidth <= 640;
        
        console.log('üì± Immediate mobile detection:', {
          userAgent: userAgent.substring(0, 50) + '...',
          isMobileDevice,
          isIPhone,
          viewportWidth,
          isMobileSize
        });
        
        // Force mobile class for ANY mobile device or small screen
        if (isMobileDevice || isIPhone || isMobileSize || viewportWidth <= 768) {
          document.body.classList.add('mobile-v1');
          console.log('üì± Mobile class FORCED for mobile device');
        }
        
        // Also run on window load as final fallback
        window.addEventListener('load', function() {
          if (isMobileDevice || isIPhone || isMobileSize || viewportWidth <= 768) {
            document.body.classList.add('mobile-v1');
            console.log('üì± Mobile class FORCED on window load');
          }
        });
        
        // Run multiple times to ensure it sticks
        setTimeout(() => {
          if (isMobileDevice || isIPhone || isMobileSize || viewportWidth <= 768) {
            document.body.classList.add('mobile-v1');
            console.log('üì± Mobile class FORCED on timeout');
          }
        }, 100);
        
        setTimeout(() => {
          if (isMobileDevice || isIPhone || isMobileSize || viewportWidth <= 768) {
            document.body.classList.add('mobile-v1');
            console.log('üì± Mobile class FORCED on second timeout');
          }
        }, 500);
      })();
    </script>
    
    <!-- Notifications (once, at end of body) -->
    <div id="toastRegion" aria-live="polite" aria-atomic="true" class="toast-region"></div>
    <div id="bannerRegion" aria-live="assertive" aria-atomic="true" class="banner-region"></div>

         <!-- Share Modal (once at end of body) -->
     <div id="shareModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="shareTitle" hidden>
       <div class="modal-backdrop" data-close></div>
       <div class="modal-card" role="document">
         <header class="modal-head">
           <h2 id="shareTitle">Share</h2>
           <button id="shareCloseBtn" class="icon-btn" aria-label="Close" data-close>&times;</button>
         </header>

         <div class="modal-body">
           <p id="shareHint" class="share-hint">Share this page or item.</p>

           <label for="shareUrl" class="visually-hidden">Link</label>
           <input id="shareUrl" class="share-url" type="url" inputmode="url" autocomplete="off" readonly>

           <div class="share-actions">
             <button id="shareNativeBtn" class="btn">Share‚Ä¶</button>
             <button id="shareCopyBtn" class="btn">Copy link</button>
           </div>

           <div class="share-feedback" id="shareFeedback" aria-live="polite"></div>
         </div>
       </div>
     </div>

     <!-- Pro Upsell Modal -->
     <div id="proUpsellModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="proUpsellTitle" hidden>
       <div class="modal-backdrop" data-close></div>
       <div class="modal-card" role="document">
         <header class="modal-head">
           <h2 id="proUpsellTitle">Go Pro</h2>
           <button class="icon-btn" aria-label="Close" data-close>&times;</button>
         </header>
         <div class="modal-body">
           <ul style="margin:0 0 8px 16px;">
             <li>Extra daily trivia questions</li>
             <li>CSV export & batch actions</li>
             <li>HD posters & spotlight extras</li>
           </ul>
           <div style="display:flex; gap:8px;">
             <button id="proActivateBtn" class="btn">Start Pro</button>
             <button class="btn" data-close>Not now</button>
           </div>
           <div id="proUpsellFeedback" class="share-feedback" aria-live="polite"></div>
         </div>
       </div>
     </div>

    <!-- Add script AFTER your other inline/app scripts -->
    <script defer src="scripts/notifications.js"></script>
    
    <!-- After your other app scripts -->
    
    <script defer src="scripts/tmdb-seed.js"></script>
    <script defer src="scripts/curated-seed.js"></script>
         <script defer src="scripts/curated-rows.js"></script>
     <script defer src="scripts/trivia.js"></script>
     <script defer src="scripts/spotlight.js"></script>
     <script defer src="scripts/series-org.js"></script>
     <script defer src="scripts/share-modal.js"></script>
     <script defer src="scripts/search-tips.js"></script>
     <script defer src="scripts/pro-gate.js"></script>
  </body>
</html>