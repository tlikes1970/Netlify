<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Home Default Landing</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .result { margin: 10px 0; padding: 8px; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .test-links { margin: 10px 0; }
        .test-links a { display: inline-block; margin: 5px 10px 5px 0; padding: 8px 12px; background: #007bff; color: white; text-decoration: none; border-radius: 4px; }
        .test-links a:hover { background: #0056b3; }
    </style>
</head>
<body>
    <h1>ðŸ§ª Home Default Landing Test</h1>
    
    <div class="test-section">
        <h3>Test 1: Feature Flag Status</h3>
        <div id="test1-result"></div>
    </div>
    
    <div class="test-section">
        <h3>Test 2: Scroll Restoration Status</h3>
        <div id="test2-result"></div>
    </div>
    
    <div class="test-section">
        <h3>Test 3: Current URL and Hash</h3>
        <div id="test3-result"></div>
    </div>
    
    <div class="test-section">
        <h3>Test 4: Scroll Position</h3>
        <div id="test4-result"></div>
    </div>
    
    <div class="test-section">
        <h3>Test 5: Hash Navigation Tests</h3>
        <div id="test5-result"></div>
        <div class="test-links">
            <a href="#currently-watching">Test #currently-watching</a>
            <a href="#home">Test #home</a>
            <a href="#trending">Test #trending</a>
            <a href="/">Test / (no hash)</a>
        </div>
    </div>
    
    <div class="test-section">
        <h3>Test 6: Route Fix Functions</h3>
        <div id="test6-result"></div>
        <button onclick="testRouteFix()">Test Route Fix Functions</button>
    </div>

    <!-- Load required scripts -->
    <script src="js/flags.js"></script>
    <script src="scripts/flags-init.js"></script>
    <script src="scripts/route-fix.js"></script>

    <script>
        function addResult(testId, message, type = 'info') {
            const resultDiv = document.getElementById(testId);
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.textContent = message;
            resultDiv.appendChild(div);
        }

        function testRouteFix() {
            addResult('test6-result', 'Testing Route Fix functions...', 'info');
            
            if (window.RouteFix) {
                addResult('test6-result', 'âœ… RouteFix object available', 'success');
                addResult('test6-result', `Enabled: ${window.RouteFix.isEnabled()}`, 'info');
                
                // Test normalize function
                try {
                    window.RouteFix.normalizeInitialLocation();
                    addResult('test6-result', 'âœ… normalizeInitialLocation() executed', 'success');
                } catch (e) {
                    addResult('test6-result', `âŒ normalizeInitialLocation() error: ${e.message}`, 'error');
                }
                
                // Test ensure top function
                try {
                    window.RouteFix.ensureTopOnLoad();
                    addResult('test6-result', 'âœ… ensureTopOnLoad() executed', 'success');
                } catch (e) {
                    addResult('test6-result', `âŒ ensureTopOnLoad() error: ${e.message}`, 'error');
                }
            } else {
                addResult('test6-result', 'âŒ RouteFix object not available', 'error');
            }
        }

        function updateScrollPosition() {
            const scrollY = window.scrollY;
            const scrollX = window.scrollX;
            
            if (scrollY === 0 && scrollX === 0) {
                addResult('test4-result', `âœ… Perfect! Scroll position: (${scrollX}, ${scrollY})`, 'success');
            } else {
                addResult('test4-result', `âš ï¸ Not at top! Scroll position: (${scrollX}, ${scrollY})`, 'warning');
            }
        }

        // Wait for scripts to load
        document.addEventListener('DOMContentLoaded', function() {
            // Test 1: Feature Flag Status
            addResult('test1-result', 'ðŸ” Checking feature flag...', 'info');
            
            if (window.FLAGS?.route_fix_home_default) {
                addResult('test1-result', 'âœ… route_fix_home_default flag is ENABLED', 'success');
            } else {
                addResult('test1-result', 'âŒ route_fix_home_default flag is DISABLED', 'error');
            }
            
            // Test 2: Scroll Restoration Status
            addResult('test2-result', 'ðŸ” Checking scroll restoration...', 'info');
            
            if ('scrollRestoration' in history) {
                const restoration = history.scrollRestoration;
                if (restoration === 'manual') {
                    addResult('test2-result', 'âœ… Scroll restoration set to MANUAL', 'success');
                } else {
                    addResult('test2-result', `âš ï¸ Scroll restoration is ${restoration.toUpperCase()}`, 'warning');
                }
            } else {
                addResult('test2-result', 'âš ï¸ Scroll restoration not supported', 'warning');
            }
            
            // Test 3: Current URL and Hash
            addResult('test3-result', 'ðŸ” Checking current URL...', 'info');
            addResult('test3-result', `URL: ${location.href}`, 'info');
            addResult('test3-result', `Hash: ${location.hash || '(none)'}`, 'info');
            addResult('test3-result', `Pathname: ${location.pathname}`, 'info');
            
            // Test 4: Scroll Position
            addResult('test4-result', 'ðŸ” Checking scroll position...', 'info');
            updateScrollPosition();
            
            // Test 5: Hash Navigation Tests
            addResult('test5-result', 'ðŸ” Testing hash navigation...', 'info');
            addResult('test5-result', 'Click the test links above to see if they cause unwanted scrolling', 'info');
            
            // Monitor scroll changes
            let scrollTimeout;
            window.addEventListener('scroll', function() {
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(() => {
                    updateScrollPosition();
                }, 100);
            });
            
            // Monitor hash changes
            window.addEventListener('hashchange', function() {
                addResult('test5-result', `Hash changed to: ${location.hash || '(none)'}`, 'info');
                updateScrollPosition();
            });
        });
    </script>
</body>
</html>




