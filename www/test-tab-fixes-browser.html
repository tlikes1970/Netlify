<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tab Functionality Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .pass { color: green; }
        .fail { color: red; }
        .warn { color: orange; }
        .test-result { margin: 5px 0; }
        button { margin: 5px; padding: 10px; }
    </style>
</head>
<body>
    <h1>ðŸ§ª Tab Functionality Test Suite</h1>
    <p>This page tests the tab functionality fixes. Open the browser console to see detailed results.</p>
    
    <div class="test-section">
        <h2>Test Controls</h2>
        <button onclick="runAllTests()">Run All Tests</button>
        <button onclick="testTabClicks()">Test Tab Clicks</button>
        <button onclick="clearResults()">Clear Results</button>
    </div>
    
    <div id="results" class="test-section">
        <h2>Test Results</h2>
        <div id="testOutput">Click "Run All Tests" to start...</div>
    </div>

    <script>
        // Test results container
        const results = document.getElementById('testOutput');
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.textContent = message;
            results.appendChild(div);
            console.log(message);
        }
        
        function clearResults() {
            results.innerHTML = '';
        }
        
        function runAllTests() {
            clearResults();
            log('ðŸ§ª Starting comprehensive tab functionality tests...', 'info');
            
            testTabStructure();
            testEventHandlers();
            testGlobalFunctions();
            testTabClicks();
            testTabSections();
            testCSSClasses();
            testPerformanceMonitor();
            
            log('âœ… All tests completed!', 'pass');
        }
        
        function testTabStructure() {
            log('\nðŸ“‹ Testing tab button structure:', 'info');
            
            const tabButtons = [
                'homeTab', 'watchingTab', 'wishlistTab', 'watchedTab', 'discoverTab', 'settingsTab'
            ];
            
            let allPassed = true;
            
            tabButtons.forEach(buttonId => {
                const button = document.getElementById(buttonId);
                if (button) {
                    const hasTabClass = button.classList.contains('tab');
                    const hasCorrectId = button.id === buttonId;
                    
                    if (hasTabClass && hasCorrectId) {
                        log(`âœ… ${buttonId}: exists, has .tab class, correct ID`, 'pass');
                    } else {
                        log(`âŒ ${buttonId}: missing .tab class or incorrect ID`, 'fail');
                        allPassed = false;
                    }
                } else {
                    log(`âŒ ${buttonId}: not found`, 'fail');
                    allPassed = false;
                }
            });
            
            if (allPassed) {
                log('âœ… All tab buttons have correct structure', 'pass');
            } else {
                log('âŒ Some tab buttons have structural issues', 'fail');
            }
        }
        
        function testEventHandlers() {
            log('\nðŸŽ¯ Testing event handlers:', 'info');
            
            // Check if FlickletApp exists
            if (window.FlickletApp) {
                log('âœ… FlickletApp exists', 'pass');
                
                if (typeof window.FlickletApp.switchToTab === 'function') {
                    log('âœ… FlickletApp.switchToTab function exists', 'pass');
                } else {
                    log('âŒ FlickletApp.switchToTab function missing', 'fail');
                }
            } else {
                log('âŒ FlickletApp not found', 'fail');
            }
            
            // Check global switchToTab
            if (typeof window.switchToTab === 'function') {
                log('âœ… window.switchToTab function exists', 'pass');
            } else {
                log('âŒ window.switchToTab function missing', 'fail');
            }
        }
        
        function testGlobalFunctions() {
            log('\nðŸŒ Testing global function fallback:', 'info');
            
            if (typeof window.switchToTab === 'function' && window.FlickletApp) {
                // Test if global function calls FlickletApp
                const originalSwitchToTab = window.FlickletApp.switchToTab;
                let called = false;
                
                window.FlickletApp.switchToTab = function(tab) {
                    called = true;
                    log(`âœ… Global switchToTab called FlickletApp.switchToTab with: ${tab}`, 'pass');
                };
                
                // Test call
                window.switchToTab('test');
                
                if (called) {
                    log('âœ… Global switchToTab correctly calls FlickletApp.switchToTab', 'pass');
                } else {
                    log('âŒ Global switchToTab does not call FlickletApp.switchToTab', 'fail');
                }
                
                // Restore original
                window.FlickletApp.switchToTab = originalSwitchToTab;
            } else {
                log('âš ï¸ Cannot test global function - missing dependencies', 'warn');
            }
        }
        
        function testTabClicks() {
            log('\nðŸ–±ï¸ Testing tab click simulation:', 'info');
            
            const tabButtons = [
                'homeTab', 'watchingTab', 'wishlistTab', 'watchedTab', 'discoverTab', 'settingsTab'
            ];
            
            tabButtons.forEach(buttonId => {
                const button = document.getElementById(buttonId);
                if (button) {
                    log(`Testing click on ${buttonId}...`, 'info');
                    
                    // Create and dispatch click event
                    const clickEvent = new MouseEvent('click', {
                        bubbles: true,
                        cancelable: true,
                        view: window
                    });
                    
                    try {
                        button.dispatchEvent(clickEvent);
                        log(`âœ… ${buttonId} click event dispatched successfully`, 'pass');
                    } catch (error) {
                        log(`âŒ ${buttonId} click event failed: ${error.message}`, 'fail');
                    }
                } else {
                    log(`âŒ ${buttonId} not found for click testing`, 'fail');
                }
            });
        }
        
        function testTabSections() {
            log('\nðŸ“„ Testing tab sections:', 'info');
            
            const tabSections = [
                'homeSection', 'watchingSection', 'wishlistSection', 'watchedSection', 'discoverSection', 'settingsSection'
            ];
            
            let allSectionsExist = true;
            
            tabSections.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    log(`âœ… ${sectionId} exists`, 'pass');
                } else {
                    log(`âŒ ${sectionId} not found`, 'fail');
                    allSectionsExist = false;
                }
            });
            
            if (allSectionsExist) {
                log('âœ… All tab sections exist', 'pass');
            } else {
                log('âŒ Some tab sections are missing', 'fail');
            }
        }
        
        function testCSSClasses() {
            log('\nðŸŽ¨ Testing CSS classes:', 'info');
            
            const homeSection = document.getElementById('homeSection');
            if (homeSection) {
                const hasTabSectionClass = homeSection.classList.contains('tab-section');
                const hasActiveClass = homeSection.classList.contains('active');
                
                if (hasTabSectionClass) {
                    log('âœ… homeSection has .tab-section class', 'pass');
                } else {
                    log('âŒ homeSection missing .tab-section class', 'fail');
                }
                
                if (hasActiveClass) {
                    log('âœ… homeSection has .active class', 'pass');
                } else {
                    log('âš ï¸ homeSection does not have .active class (may be normal)', 'warn');
                }
            } else {
                log('âŒ homeSection not found for CSS testing', 'fail');
            }
        }
        
        function testPerformanceMonitor() {
            log('\nðŸ“Š Testing performance monitor:', 'info');
            
            if (window.PerformanceMonitor) {
                log('âœ… PerformanceMonitor exists', 'pass');
                
                if (typeof window.PerformanceMonitor.observeUserInteractions === 'function') {
                    log('âœ… observeUserInteractions method exists', 'pass');
                } else {
                    log('âŒ observeUserInteractions method missing', 'fail');
                }
            } else {
                log('âš ï¸ PerformanceMonitor not available', 'warn');
            }
        }
        
        // Auto-run tests when page loads
        window.addEventListener('load', () => {
            log('ðŸš€ Page loaded, running initial tests...', 'info');
            setTimeout(runAllTests, 1000); // Wait a bit for other scripts to load
        });
    </script>
</body>
</html>
