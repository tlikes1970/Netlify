<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tab Visual Test</title>
    <style>
        body {
            font-family: system-ui, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #ddd;
        }
        .test-controls {
            margin: 20px 0;
            padding: 16px;
            background: white;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        button {
            padding: 8px 16px;
            margin: 4px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            cursor: pointer;
        }
        button:hover {
            background: #f0f0f0;
        }
        .console-output {
            background: #f8f8f8;
            padding: 12px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
    <link rel="stylesheet" href="/styles/tabs.css">
</head>
<body>
    <h1>Tab Visual Improvements Test</h1>
    
    <div class="test-container">
        <h3>Segmented Control Style Tabs</h3>
        <nav id="navigation" role="tablist" aria-label="Sections" class="tabs">
            <button id="homeTab" class="tab is-active" role="tab" aria-controls="homeSection" aria-selected="true" tabindex="0">
                <span class="tab-label">Home</span>
            </button>
            <button id="watchingTab" class="tab" role="tab" aria-controls="watchingSection" aria-selected="false" tabindex="-1">
                <span class="tab-label">Currently Watching</span>
                <span class="badge" id="watchingBadge">5</span>
            </button>
            <button id="wishlistTab" class="tab" role="tab" aria-controls="wishlistSection" aria-selected="false" tabindex="-1">
                <span class="tab-label">Want to Watch</span>
                <span class="badge" id="wishlistBadge">12</span>
            </button>
            <button id="watchedTab" class="tab" role="tab" aria-controls="watchedSection" aria-selected="false" tabindex="-1">
                <span class="tab-label">Already Watched</span>
                <span class="badge" id="watchedBadge">23</span>
            </button>
            <button id="discoverTab" class="tab" role="tab" aria-controls="discoverSection" aria-selected="false" tabindex="-1">
                <span class="tab-label">Discover</span>
            </button>
        </nav>
    </div>

    <div class="test-container">
        <h3>Badge Inversion Test</h3>
        <p>Click tabs to see badges invert on active state:</p>
        <nav class="tabs">
            <button class="tab is-active">
                <span class="tab-label">Active Tab</span>
                <span class="badge">42</span>
            </button>
            <button class="tab">
                <span class="tab-label">Inactive Tab</span>
                <span class="badge">17</span>
            </button>
        </nav>
    </div>

    <div class="test-controls">
        <h3>Test Controls</h3>
        <button onclick="testTabActivation()">Test Tab Activation</button>
        <button onclick="testBadgeInversion()">Test Badge Inversion</button>
        <button onclick="testLabelGuards()">Test Label Guards</button>
        <button onclick="checkVisualStates()">Check Visual States</button>
    </div>

    <div class="test-controls">
        <h3>Console Output</h3>
        <div id="console-output" class="console-output">
            Ready for testing...
        </div>
    </div>

    <script type="module">
        // Mock console.log to capture output
        const originalLog = console.log;
        const outputDiv = document.getElementById('console-output');
        
        function addOutput(message) {
            const timestamp = new Date().toLocaleTimeString();
            outputDiv.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            outputDiv.scrollTop = outputDiv.scrollHeight;
        }
        
        console.log = (...args) => {
            originalLog(...args);
            addOutput(args.join(' '));
        };

        // Import and test the nav system
        let initTabs;
        
        try {
            const navModule = await import('./js/nav-init.js');
            initTabs = navModule.initTabs;
            console.log('✅ Nav module loaded successfully');
        } catch (e) {
            console.error('❌ Failed to load nav module:', e);
        }

        // Initialize tabs
        if (initTabs) {
            initTabs();
            console.log('✅ Tabs initialized with visual improvements');
        }

        // Test functions
        window.testTabActivation = () => {
            console.log('🔄 Testing tab activation...');
            const tabs = document.querySelectorAll('#navigation .tab');
            
            tabs.forEach((tab, index) => {
                setTimeout(() => {
                    tab.click();
                    const activeTab = document.querySelector('#navigation .tab.is-active');
                    const activeBadge = activeTab?.querySelector('.badge');
                    console.log(`Tab ${index + 1} clicked - Active: ${activeTab?.querySelector('.tab-label')?.textContent}, Badge: ${activeBadge?.textContent}`);
                }, index * 500);
            });
        };

        window.testBadgeInversion = () => {
            console.log('🔄 Testing badge inversion...');
            const testTabs = document.querySelectorAll('.test-container .tabs .tab');
            testTabs.forEach((tab, index) => {
                setTimeout(() => {
                    // Toggle active state
                    testTabs.forEach(t => t.classList.remove('is-active'));
                    tab.classList.add('is-active');
                    
                    const badge = tab.querySelector('.badge');
                    const isActive = tab.classList.contains('is-active');
                    console.log(`Tab ${index + 1} ${isActive ? 'activated' : 'deactivated'} - Badge color: ${isActive ? 'white (inverted)' : 'gray (normal)'}`);
                }, index * 300);
            });
        };

        window.testLabelGuards = () => {
            console.log('🔄 Testing label guards...');
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach((tab, index) => {
                const label = tab.querySelector('.tab-label');
                const badge = tab.querySelector('.badge');
                console.log(`Tab ${index + 1}: Label="${label?.textContent}", Badge="${badge?.textContent || 'none'}"`);
            });
        };

        window.checkVisualStates = () => {
            console.log('🔄 Checking visual states...');
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                const isActive = tab.classList.contains('is-active');
                const label = tab.querySelector('.tab-label')?.textContent;
                const badge = tab.querySelector('.badge');
                const badgeColor = isActive ? 'white (inverted)' : 'gray (normal)';
                console.log(`${label}: active=${isActive}, badge=${badge?.textContent || 'none'}, badge-color=${badgeColor}`);
            });
        };

        // Auto-test on load
        setTimeout(() => {
            console.log('🚀 Starting visual test...');
            checkVisualStates();
        }, 1000);
    </script>
</body>
</html>


